# -*-makefile-*-
# makeopts template file for M
#
# $Id$
#
# set build root directory:
BUILDDIR = @BUILDDIR@
top_builddir=@BUILDDIR@

# the c-client library:
CCLIENTDIR=$(BUILDDIR)/extra/src/c-client
CCLIENTINCLUDE=$(CCLIENTDIR)
CCLIENTLIB=$(CCLIENTDIR)/c-client.a
CCLIENTOSTYPE=@CCOSTYPE@
CCLIENT_EXTRAAUTHENTICATORS=@CCLIENT_EXTRAAUTHENTICATORS@
CCLIENT_EXTRACFLAGS=@CCLIENT_EXTRACFLAGS@

SSL_LIBS=@SSL_LIBS@

# where we have the Icon xpms:
ICONDIR=$(BUILDDIR)/src/icons

# compiler flags
ODIR=.

# this will be set or unset
@MAKE_USE_PYTHON@
@MAKE_USE_SWIG@
@MAKE_DEBUG@
@MAKE_EXPERIMENTAL@
@MAKE_LIBTOOL@
@MAKE_USE_MODULES@
@MAKE_USE_LEAKTRACER@
@MAKE_PISOCKLIB@
@MAKE_HAVE_LIBMAL@

ifdef HAVE_LIBMAL
LIBMAL_DIR=$(BUILDDIR)/extra/src/libmal
PISOCK_LIB:=$(PISOCK_LIB) -L$(LIBMAL_DIR)/.libs -lmal
endif



# libraries needed by the modules, linked against individually in the modules
# directory, but listed here in case we build a static library:
ifeq ($(USE_MODULES),static)
# for MAL:
MODULES_LIBS:=$(PISOCK_LIB)
else
MODULES_LIBS=
endif
# canonical host
CANONICAL_HOST=@host@

# DOC++/kdoc (doc++ is preferred, -r to do short filenames to avoid dpkg bug)
DOCXXHTML=doc++ -r -f -k -u -k $(DXXTBL) -H -d $(BUILDDIR)/doc/classes
DOCXXTEX =doc++ -f -k -u -k $(DXXTBL) -H -t -o $(BUILDDIR)/doc/classes.tex
KDOCHTML = kdoc -H -d $(BUILDDIR)/doc/classes -u $(BUILDDIR) -a -i -e M  
KDOCTEX =  kdoc -T -d $(BUILDDIR)/doc/classes -u $(BUILDDIR) -a -i -e M
SCANDOCHTML = @PERL@ $(BUILDDIR)/extra/scandoc/scandoc.pl  -i $(BUILDDIR)/extra/scandoc/Mtemplate.html -p $(BUILDDIR)/doc/classes/ -t 3 
SCANDOCTEX  = echo "Cannot generate .tex class documentation with scandoc."
DOCHTML=@DOCHTML@
DOCTEX=@DOCTEX@
LATEX=@LATEX@
MAKEINDEX=@MAKEINDEX@
DVIPS=@DVIPS@
LATEX2HTML=@LATEX2HTML@ -local_icons
XGETTEXT=@XGETTEXT@
MSGFMT=@MSGFMT@
PERL=@PERL@
PSTOPDF=@PSTOPDF@

# compiler stuff
CC = @CC@
CPP = @CPP@
CXX = @CXX@
LIBTOOL = @LIBTOOL@
CXXCPP = @CXXCPP@
CPPFLAGS =@CPPFLAGS@
AR = ar
RANLIB = @RANLIB@
YACC = @YACC@

# SWIG
ifdef USE_SWIG
SWIG = @SWIG@
SWIGFLAGS = -c++ -python -shadow -dhtml -c
SWIGFLAGS_LIBSWIG = -c++ -python -shadow 
SWIG_LIBS = #no longer needed -lswig -lswigpy
else
SWIG= echo
SWIGFLAGS=
SWIGFLAGS_LIBSWIG=
SWIG_LIBS=
endif

# other stuff
RM = rm -f
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@
M4=@M4@ 

DESTDIR = @prefix@
# Directory in which to install scripts.
BINDIR = $(DESTDIR)/bin
# Directory in which to install library files.
DATADIR = $(DESTDIR)/share/Mahogany
# where to install docs
DOCDIR = $(DATADIR)/doc

PREFIX=@prefix@
# for the dynamic linker, better than using -rpath
LD_RUN_PATH=$(DATADIR)/$(CANONICAL_HOST)/lib
MODULEDIR=$(DATADIR)/$(CANONICAL_HOST)/modules

ifdef USE_LIBTOOL
LINK = $(LIBTOOL) --mode=link $(CXX) -Wl-r$(LD_RUN_PATH)
else
LINK = $(CXX) -Wl-r$(LD_RUN_PATH)
#-Wl-export-dynamic 
endif

DEF = -DM_PREFIX="\"$(PREFIX)/\"" -DM_CANONICAL_HOST="\"$(CANONICAL_HOST)\""
INC = -I$(BUILDDIR)/include -I$(BUILDDIR)/extra/include -I$(BUILDDIR)/include/gui -I$(CCLIENTINCLUDE) 
CFLAGS   = @CFLAGS@  $(CPPFLAGS) $(DEF) $(INC)
CXXFLAGS = @CXXFLAGS@ $(CPPFLAGS) $(DEF) $(INC)
# for the python code:
CXXFLAGS_RELAXED = @CXXFLAGS_RELAXED@ $(CPPFLAGS) $(DEF) $(INC)
LDFLAGS = @LDFLAGS@

LIBS=$(CCLIENTLIB) $(MODULES_LIBS) $(SSL_LIBS) $(SWIG_LIBS) @LIBS@ 
LIBS_STATIC=$(CCLIENTLIB) $(MODULES_LIBS) $(SSL_LIBS) $(SWIG_LIBS) @LIBS_STATIC@ 
GUI_LIBS=@GTK_LDFLAGS@
GUI_LIBS_STATIC=@GUI_LIBS_STATIC@
