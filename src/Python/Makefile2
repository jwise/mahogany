# Makefile2 for src/Python directory
#
# $Id$
#
# This is the actual makefile defining all targets apart from clean and
# gets called by Makefile. This two-step process is required to cleanly
# override any targets defined in makerules.
#

CWD = Python

SWIGSRC = MAppBase.i MailFolder.i MString.i Profile.i Message.i MObject.i
CPPSRC = InitPython.cpp PythonHelp.cpp
SRC=$(CXXSRC) *.cpp

CPPTARGETS = $(SWIGSRC:.i=.cpp) swiglib.cpp
PYTARGETS = $(SWIGSRC:.i=.py)
OBJECTS    = $(CPPTARGETS:.cpp=.o) $(CPPSRC:.cpp=.o)


all:	$(OBJECTS) $(PYTARGETS)

.PHONY: mkswig all

include ../../makerules 
include ../../makeopts
include .depend

CPPFLAGS:=$(CPPFLAGS) -DSWIG_GLOBAL

ifdef USE_SWIG
swiglib.cpp: swiglib.i
	$(SWIG) $(SWIGFLAGS_LIBSWIG) -o $(ODIR)/$@ $<
else
swiglib.cpp: swiglib.i
	touch $(ODIR)/$@ 
endif


install:
	$(INSTALL) -d $(DATADIR)/scripts
	for i in *.py Scripts/*.py; do $(INSTALL_DATA) $$i $(DATADIR)/scripts; done
	$(INSTALL) -d $(DOCDIR)/Python
	for i in *.html; do $(INSTALL_DATA) $$i $(DOCDIR)/Python; done
	$(RM) $(DATADIR)/scripts/dummy.py $(DOCDIR)/Python/dummy.html

#%.py: %.i
#	$(SWIG) $(SWIGFLAGS) $<
