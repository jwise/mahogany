-*- text -*-
TODO list for M
$Id$

*********************************************************************
*** Plans for the next release(s):
*********************************************************************

** These are the main topics planned for the next release(s):

- completion of filtering rules/scoring code
- subscription management for NNTP/IMAP/newsspool
- DND with KDE/Gnome filemanagers (now supported by wxGTK)
- Finish the new message editor code: rich-text editing
- Templates/style-sheets for message composition and flexible reply
  handling 
- Messages sorting, threading, scoring and searching
- fine tune printing to remove occasional printing of too many lines
  around page breaks
- multi-threading to avoid delays and timeouts
- GPG/PGP support
- built-in HTML viewer

GENERAL ROADMAP/ORDER OF THINGS:

  1. fix remaining bugs in Windows version  ---> make new common release
  2. finish filtering code
  3. do multi-threading before adding sorting etc

*********************************************************************
*** Currently being worked on:
***   (This section is a bit of a mess as it is our day to day
***    noticeboard where we list whatever comes to our mind.)
*********************************************************************

*********************************************************************
*** wxMSW bugs:
*********************************************************************
 - memory leaks (some from cclient, others - not sure)
 - radiobox doesn't respect constraints, adjusts its size as it thinks is better
 - in folder create/properties dialog there is missing UpdateUI() right
   after creation - add it somewhere
 - lock file checking for INBOX:
   + it does locking under Windows too, but the lock file names are different
     Testing for FOLDER.lock* now, is that fine?
 - wxLayout completely broken:
   + scrollbars are not updated nor even drawn at all
   + vertical and horizontal lines across the window
   + some areas are duplicated (displayed twice with some small shift)
   + ...
 - CR/LF problems when replying to the messages

*********************************************************************
*** VZ:
*********************************************************************

- help button for first folder create page nees a help id
  KB: couldn't even find out where you create the button :-(
- when user level is >=1 (advanced) show full preferences pages in
  folder notbook

- If any top level window is open (messageview/composeview), the
  application will not exit. Happened after you changed the exit
  behaviour, has been a bug for months.
    VZ: can't reproduce this

- closing splashscreen calls wxApp::ExitMainLoop() which is wrong!
  VZ: can't reproduce this
  KB: only if no other window is open

- foldertreectrl in folder selection dialog should have keyboard focus 
  and should not open folder when pressed return, but select it :-)

- Would it be possible to set the icon in the treectrl on a per-folder 
  basis? I'd like to read the iconname from the folder profile, that
  would allow nice things such as a "trash/junk" folder, etc.

- Could you have a look at the setting of the default columns sizes in 
  wxFolderView.cpp, please?  Currently it gets called in the
  constructor which doesn't work properly, but moving that code to
  Clear(), using a SetConfigPath(), just before RestoreWidths() is
  called, didn't work either. 

- configuration dialog for columns in folderview
  + VZ: will do

*********************************************************************
*** KB:
*********************************************************************

- generally: think of a way to modularise and load plug-ins
  (Especially useful as we add more functionality such as the calendar 
   or more addressbook formats.)
- drop classes documentation from archive/docs!!
- finish and fix message view/editor: recalcuating/re-layout should be 
  one function, operating on lines marked as dirty. This might also
  fix the cursor bugs.
- add icons to doc++ generated docs
- document python callback behaviour for incoming folders, possibly do 
  testing for callback results in CollectOneFolder!!
- add configure option for python path
- when sending message failed, don't make composeview readonly but rebuild it
  after editing
- more configurability for news
- do we really need to scan /var/lib/news/active?
- add address auto collection to compose view
- add a popup dialog to edit message headers in composeview
- some html mail import/filtering of tags (easy, quick and dirty)
- Problem: mail uids and nums are long, WXARRAYINT.Count() is int,
  content is int.
- do not redraw messageview if the message is the one currently being
  shown (DONE, better:)
  -- option to keep wxLayoutList around for reuse?
- when inserting filetype of unknown MIME type, prompt for it
- speed up copy mail to folder by cusing c-client functionality
- wxComposeView: if replying, only mark message as answered if reply
  got sent --> difficult
- if time permits: vcard-import
- use mm_critical() and delay application exit if necessary
- add "double click to open" profile option support to folder list ctrl
- enable/disable edit menu entries as needed
- check whether the test in MailFolderCC.cpp, line 949 really works as 
  expected 
- add translation macros to unmodified c-client lib and submit it to
  MRC. Use two macros, a translating one _() and a non-translating one 
  __() to easily find new strings later. Use common header for defines.
- fix alpha related c-client bugs?
- Ask again on c-client@u.washington.edu about the last two points.
*********************************************************************
*** Miscellaneous Todo:
*********************************************************************

- move to scandoc instead of doc++??
- add calendar tool/plugin
- if exists, use /etc/M.conf or /etc/Mahogany.conf instead of
  prefix/Mahogany/M.conf.
- merge in settings from some remote location, possibly using ftp/http 
- use wxHtmlHelp classes ? use gtkxmhtml widget?
- remove classes documentation from normal docs and no longer include
  it in the archive, create separate make target for it. It's too large!
- add closing delay for sentmail folder to avoid reopening it each time
- add SIGSEGV handler for safe exit, to attempt and safe things
- change of settings in the msg view section of the options dlg should generate
  an event which would propagete to all open msg views.
- make [Apply] work too!
- when inserting filetype of unknown MIME type, prompt for it,
  possibly have a MIME types editor (similar to netscape's?)
- forward messsages as 7Bit, i.e. provide 7bit/8bit selection in
  SendMessageCC::AddPart()
 - easy to implement but useful feature: "check for new mail now"
 - possibly have a MIME types editor (similar to netscape's?)
  - easy: add support for email-to-fax gateway at www.tpc.int and
    their coverpage
 - document scripts in extra/scripts
 - somehow allow different configs for different hosts, maybe a
   [M/HOSTNAME/Profiles] section overriding [M/Profiles]?
 - toggle readonly status of mailboxes?
 - GUI problems:
  - folder tree control should (configurable on a per-folder basis)
    highlight and count the number of new messages
  - add "Inline" option for MIME popup on graphics
  - typing keys while M starts up can cause segfault (startup-splash
    event handling?)

- ADB:
  + add "add current address to ADB" to compose view
  + should be updated when new entries are created (can't be deleted from
    elsewhere for now...), add an event for this
  - add ADB support for $HOME/.mailrc
    ( lines: "alias john_doe  john@doe.com, second@xxx.uuu, ...")
  - fix remaining BBDB/ADB problems (low priority)

- alternative treecontrol instead of listctrl for folderview

- use wxURL to retrieve remote configuration files and import them,
  maybe even retrieve files to use as folders or address books`?

- wxFolderCreateNotebook should be split into base class and 2 derivations:
  wxFolderCreateNotebook and wxFolderPropNotebook

- drag and drop of messages between folders
- Are wxConfig/Profile GetNextGroup()/GetFirstGroup()  thread-safe??
  I started marking possible problems for multi-threaded code with
  //FIXME:MT
  VZ: ok, I usually do it too (always) except for the "obvious" problems, e.g.
      usage of static vars. I always name them with "s_" prefix (for this
      reason too) so it should be quite easy to do a grep for them later
  - MT-problem: rfc822_extraheaders()

- add "Send Digest"
- add "Send bug report"
- add "Send group reply/Followup"

- detect one's own messages (i.e. mark "Myself" in "From:" or, as XFMail
  does, mark "To: ..." in "From:" column for them) and optionally suppress them
  completely.

- add !(command) expansion to wxConfig, i.e.
  VAR=!(hostname):me would execute "hostname" and return "hydra.medieval.de:me"

- only quote the selected text in reply/forward if there is any selection
  (as in XFMail) - very handy
- "Syntax highlighting" for replies

  + implement "internal clipboard" for
    - cut-&-paste
    - drag-&-drop

- UI things
  + we should somehow merge the toolbars into the main frame toolbar if it
    shows the folder view, for example
  + session management --> should be done on wxWindows level

- Python
  + fix Python problems -- what's wrong? No idea why Setup.py doesn't work.
  + add remaining (important) interface definitions
  + user/global Minit files, security issues
  + merge in wxPython (Robin Dunn wanted to help...)

*** to implement in near future ***

- event subsystem
  + write some macros for safe casting of the event param in the handlers to
    the correct type
  + separate "folder tree change" event in "pre" and "post" kind
  + maybe introduce return values?
  + make event sending asynchronous

- news reader functions
  + get the list of newsgroup and allow to choose from them
  + "catch up" command
  + filtering of cross posted articles - would be very nice if this could be
    also used to filter the copies of received mail messages (i.e. if a
    message is sent to the mailing list and cc'd to me I'd like to read it
    only once)
  + "killfile" features and a special "quick kill" (TM) feature which would kill
    all articles of the author of the selected one

- Use configure to check for utilities, like help browser. "ReConfigure" menu.

- Edit-CC, CC messages to others but edit the individual copies before sending

- threading of messages via MessageId/References header lines
  Follow examples in SunExpert journal.

- "Power Search": search all (even compressed?) folders for a keyword
  and when found, open the folder and display the message.

- Export and import of addressbook in text format.
  I'd like a feature to select fields from the addressbook and write
  them, e.g. semicolon separated as a list to a file, so one could
  parse them in scripts or whatever else.

- message integrity verification support
  + PGP
  + MD5 (see RFC-1544 for details)


- Support for different charsets (Unicode/utf-7/8?)
  Being added to wxWindows at present.

- REMOTE-CONTROL: add support for popping window open and reading a folder of one's choice
  (for being controlled from xbiff like programs)
  idea: listen() on a socket and write socket number to a file ~/.M/socket
  Relatively simple.

- LDAP -- possibly using python ldap module or OpenLDAP.

- automatic (but optional) mail compactification (to save disk space)?
  -> this could be done using scripts?

- creation of separate index files for mail folders

- compressed mail folders / possibly together with index files


*********************************************************************
*** New MailFolder classes will be roughly like this:
*********************************************************************


		ASMailFolder  - Asynchronous MF ABC
		|
		ASMailFolderCommon - Implementing high level functionality,
		|		     using functions from ASMailFolderCC
		|
		ASMailFolderImpl   - implementing lower level functionality,
				     using synchronous MailFolder classes

		MailFolder	   - will become ABC for synchronous access
		|
		MailFolderCC	   - as is

*********************************************************************
*** Fixed, to be tested:
*********************************************************************

*********************************************************************
*** Fixed and tested:
*********************************************************************
 vi: set si tw=80:
